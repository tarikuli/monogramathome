<?php
$jsonstr = '["pemoanwisicr","pemoan","penaan","pebiba","sitobapewisw","inliyodrbibr","inmohoherchb","inyouaremaof","inliyodrba","pehoba","piriba","iniloyoba","pelibugba","pebba","peiambeofyob","pemofhoba","infwhlibelon","iloyoutomoan","stsipecubawi","pemocu1","pemocunu1","pemocunu","laenscmoslba","monogrambangle","stsimobawila","sibabawimo","pesitobr","peronucu","pelaenbawico","goovsimoba","inchba","acmobr","acmobrinsc","acmobrbllews","acbarbrenwin","barbrpewiswb","smanshbrpewi","pecllebrinsi","fingerbracelet","wibrpewisw","siinbrwcrins","pedobr","stsibr","petwoinbr","pemolebr","stsimobrwch1","pemobrwicr","pestsimobr","peblmowitobr","pescmowitobr","ovmobrinsi","pemoneandbrs1","stsimobrwch","enmoovbr","stsipemobr2","stsipemobr","stsipemo3dib","nagebrpewimo","pebrwisimope","simobrwilape","pebrwistsimo","inbrwispwo","pecu1","petabbr","pebarbr","laenbrwihech","stsimibarbrp","dowrlebrpewi","stsileiloyou","petwohebr","stsinabrinbl","enmobabr","peinbr","pesinabr","penafibr","pescnaneandb","nagebrpewina","shbrcrwhswcr","luchhabrinst","inbr","loneinstsi1","crbrinstsi","inbr1","anchorbracelet","sicrststbr","seprbr","eveyemustbr","sogoovmobr","sogopemobr","stsimobr","demobrwdist","pesiculi","peromecuinbl","petwoinmocul","pethinmoculi","pethinblmocu","blmoculi","sclemoculi","pesachbapena","acmodaea","acmodrpoea","acmodrpoea1","pestdrea","peinea","stsimoea","simoea","simoea1","mosmdastea","mosmblpoea","mosmdahoea","mogeea","simoeawifrwa","ne90021-ss","rhbenahoea","ststhonaea","stnaeainstsi","seprdaeainye","mipatedrea","sisteasof12p","seprsteawidi","mipacidrea","seprdaea","siczstea","sogomostea","jewaor","nomewaca","nowaca","pemewaca","momewaca","mojewaca","pemewaca1","pemewacabox","pemewaca2","giftbox","nowojebox","pefocobox","pewinajebox","peovpltr","pesqtr","pesetofforop","pesidetr","enjepl","pewojewacabo","pewojebox","pelane","peeveyelanew","stsibilane","pelanewicrba","stsilanepewi","silanewiblon","twoinlochne","pewisiinlane","stsitwoinlan","mopene","peinlane","stsilanepewi1","pesetoftwone","dogtasetoftw","peladogtagwi","pemecrpe","stsipenanewi","sidonaneform","stpecrnewczs","stpetogtagwc","sogopenanefo","peacinne","acblmopene","acblovmopene","acscmopene1","acscmopene","acpe11mowist2","acpe11mowist3","acpe11mowist","acpe11mowist1","acbarneenwin","setofacbarne","acnanecstsic1","acnanecstsic","acnanelstsic","innewispwoan","trshnewibi","eveyenewibi","pebibarne","wibonewibi","stsieveyenep","stsiopeveyen","stsistandmon","stsibifatrne","stsihenepewi","stsinepewisw","bonepewiswbi","fanepewiswbi1","stsicohenepe","pebi","hanepewiswbi","pecllene","stsiluchhone","tobemompenew","barhenepewis","sheyepepewis","smhenepewila","sinewicrba","instpenepewi","inbepenepewi","inblpenepewi","inlopenepewi","inpenepewich","iloyoutomoan1","stsipeloknne","coinpewibi","stsiconewisp","stsihenewisp","stsikeytoyoh","stsipeiloyou","sihenepewisp","stsipehandke","stsilonewisp","stsimoandcrw","inne","incinewispwo","pemombihene","cufatrnewisp","pelobine","petrbrswbine","fatrovbipe","lasiinneinsi","swbinepewiha","loforsonqune","stsinepewiin","hanepewiin","barnepewisii","pebarnewienm","pecolobine","siheshinne","stsiroinne","blstinne","stsihoinwibi","lasiinneinst","smcinepewila","smhenepewiin","petwoinneins","petwoinneinb","fanepewiswbi","stsipetwoinn","pestsitwoinn","pecinewiinan","brnepewiswbi","dolainneinst","inpepewiswbi","stsinepewicu","pe2siovpene","mosiinneinsi","siindenewczs","hesiinneinsi","twoinneinsi","stsistnepewi","stsiinnewicz1","enintwocipew","stsipemone","stsipetwoinn2","stsisiinne","stsipesiinmo","genepewihast","genepewihast1","genepewiin3","sismmonespch","stsimoinbarn","luchnepewisw","twotostsinep","stsienmone","bomopepewina","mohestsine","pehemolone1","molonepewien","cishloneinsc","stsienmonewb","siinnewimope","hemoneingoov","mone2","pemonesqsh","scmosine","stsihaenmone","stsidolamone","stsihechmone","stsimonewicr","stsihamo114i2","mokeyneinsi","momoneinsi1","2trsimone","pemone","pedolamobrwi","haenmonewith","lasimone","pemone1","peannane","enmoovne","enmocine","enmohene","zc90837-ss","zc90837a-ss","zc90834-ss","zc90834a-ss","stsihamo114i","sihamoneblle","dobemoneinsi","sidemonewist","siczstdemone","ovdemonewdis","rodemonewdis","demonewst","genepewimo","nagenepewisi","simowigene","simonewipech","penewisimope","simonewilape","dolamonewifr","frwapenewisi","stsimonewifr","frwapenewimo","penepewisimo1","penepewisimo","pecinanewibi","fanepewinaan","fanepewienan2","sihefanepewi","stsiinne","stsiennane","ennaneinscwi","stsipeenwisc","stsiennanesc","ennaneinblle","stsipeenwina","peenwina","pesimine","coenrineinst","stsipehene","stsipelaencr","stsiblnane","stsipecone","stsironuenba","stsibarnepew","stsinaneinbl","stsinaneinsc","pedogbone","stsimibarnan","stsiovbarnan","stsimihenane","stsiennepewi1","ponaneinstsi","stsipefane","stsioaktrnan","stsipeoaktrf","pefaneformom","stsiennepewi","hathstsinane","monewienquan","trortrstsina","stsinepewina","stsipefane1","stsipeoaktrf1","penabarne","stsicanepewi","babinepewina","conanepewisw","stsinepewina1","babinepewina1","stsinepewina3","stsinepewina2","pecinaneinsi","hathstsinane1","stsimihenane1","stsihenane","stsipepewina","pepewinaands","twopipehepew","pefaneformom1","pefaneformom2","nabarnewicut","pestsimihena","pestsimohene","penanewiswbi","pefananeform","pefatrnewisw","penanewiswbi1","hepewipefane","mawilopene","barnepewinaa","petwodine","pecufatrpe","pekinanewimo","nabarne","laenstsimiba","pecinewinaan","pestsiovdane","pestsiovnane","penastsiovpe","pecrne1","pecoschenane","penastsiovpe1","peminane","fanepewienan","ststgotohene","stsifanewi1c","enna1cipew","stsimonewi1b","infaneinstsi","inneformomin","innewispwo","ststgotodogt","stsipeinnewi","stsipecrne","stsipearne","pefanewimomh","cutoutrenane","cutouthenane","penaneatwimp","moscnane","pestsinane","pecinewihean","pesicine","pedocine","pesanewiquan","pesanewime","pecinewifona","pecinewifona1","pecinewihean1","penanewibi","pecinanewibi1","penanewibi1","petrfucinane","pesifucinane","pedofucinane","pevenane","pehonane","pestsibllena","pebarnaneinb","pesibarnanei","pebarnaneins","pesibarnanei1","stsibarnanei","pebarnane","barnewinaand","stsisinane","penane","pehaneinsi","twotoinnane","stsicutoutro1","stsicutoutro","dolaminanein","henepewinaan","stsipeinnane","lasinane","stsinane1","penanewdist","conaneinstsi","scjanane","stsitwotodon","stsiminane","pescnane","chlosess","setofminanei","setof3minane","pescnana","innane","stsinnewilic6","stsinnewilic7","stsinne","stsinnewirhl1","stsibllenane","stsihne","penane1","stsidodinane","sinanesmblfo","stsidorhbena1","stsidoplrhbe","stsizipcone","stsidodinane1","stsidorhbena","stsiennane1","peroshsine","encipe","enhepe","enthrepe","sienrepewibi","enhepew3bi","stsibidane","stpenewczst","peminape","pefohenewina","stsisobapewi","pebaspchwina","pestsijenewi","pebashwinaan","pebanewina","stsinanewipe","stsidowstnan","stsidicutsec","crnewiseprst","cutoutheshne","yegonewisicz","stsistne","stsistne1","stsiczsthene","luchhaneinst","inbarnewispw","inbarnewispw1","hamsanecklace","silich","setof4grne","faneinstsi","honeinstsi","stsiinnewicz","loneinstsi","rogoovsilone","sicrnewczsti","sogotwoinne","sogopetwoinn","sogopefoinne","sogopesixinn","trsogomone","trsogomonesp","sogomonewist","sogoovmonewd","sogopenanewi","pesogonane","sogoscnane","sogonanenawi","sogoromonewi","stsidostriwi","pe1inriwibi","stsistbiri","birist","pestriwibi1","periwibi","holiripewisw","luchhari","pebiheri","donariwibi","trstriwibi","stsistoneriw","coinriwibi","opdocistgari","stsitwoinri1","stsionesttwo","oneinitialring","petwoinri","peoneinri","pestsitwoinr","pemostsitwoi","pesiinstsiri","stsistinri","stsiinri","peinriwiswbi","peheinriwisw","stsitwoinri","oninmoriinbl","oneinmoriins","sqshmoriinsi","mocuriinsi","zr90850-ss","pebadostri","petrstriwibi","stsipedonari","nariwihe","pehaststsiri","stsidonari","cutoutnamering1","stsinari","stsinari1","stsimosina","pecutoutnari","trstbari","ankerring","siloriwiczst","sogomori","setofeaandne","pemoneandbrs","pemoneandeas","penaneandea"]'; //json_encode($data);
$jsonSku = '["CT1594","CT1596","CT1857","AS1042","AS1043","AS1442","AS1443","AS1444","AS1445","AS1446","AS1447","AS1525","AS1526","AS1527","AS1528","AS1529","AS1530","AS1531","VN1859","EN1540","EN1541","EN1542","EN1603","CT1606","CT1610","VN1611","EN1088","EN1090","FB1245","CT1858","IN1576","RA1621","RA2626","RA2629","RA1866","AS1044","AS1045","AS1046","AS1403","AS1577","IN1032","EN1091","CT1440","CT1441","CT1565","CT1598","CT1599","CT1601","CT1604","CT1605","CT1618","CT1750","CT1868","FB2088","CT2627","CT2630","VN2631","EN1250","CT1607","CT1615","CT1616","EN1038","EN1089","EN1092","EN1246","FB1247","CT1248","EN1251","CT1252","CT1475","EN1612","EN1613","EN1862","CT1863","CT1865","CT2072","EN1249","IN1031","IN1033","IN1034","IN1035","IN1036","IN1039","IN1040","IN1051","IN1489","IN2596","VN1619","VN2625","CT1624","VN1710","EN1007","EN1008","EN1113","EN1114","CT1115","CT1116","CT1117","EN1563","RA1549","RA1550","RA1551","AS1052","AS1448","CT2668","CT2671","CT2673","CT2674","CT2675","CT2676","CT1627","CT1626","CT1880","VN1881","VN1883","CT1884","IN1111","IN1179","IN1401","IN1439","IN2095","IN2571","IN2595","VN2669","IN1494","IN1495","IN2619","RG1490","RG1491","RG1492","RG2259","RG2260","RG2620","IN1414","IN1496","EN1127","EN1163","FB1278","FB1279","FB1280","FB1281","EN1398","RG1493","RG2233","AS1474","AS1524","AS1548","AS1564","AS1587","AS1592","AS1462","AS1590","AS1591","CT1697","CT1523","CT1588","CT1589","FB1125","FB1552","FB1554","CT2020","VN2024","FB2074","FB2075","VN2021","RA1006","RA1566","RA1567","RA1568","RA1569","RA2647","RA2651","RA2663","RA2665","RA1963","RA1964","RA1981","RA1994","RA2004","AS1037","AS1054","AS1056","AS1059","AS1060","AS1062","AS1063","AS1064","AS1065","AS1067","AS1068","AS1069","AS1070","AS1074","AS1076","AS1077","AS1078","AS1080","AS1085","AS1086","AS1087","AS1455","AS1533","AS1534","AS1535","AS1536","AS1537","AS1538","AS1539","AS1700","AS2681","AS1833","AS1834","AS1836","AS1837","AS1838","AS1839","AS1840","AS1841","AS1845","AS1846","AS1847","AS1848","AS1852","AS1853","AS2090","CT1004","AS1061","AS1346","CT1364","CT1375","CT1377","CT1379","CT1382","CT1449","EN1450","AS1451","AS1452","CT1454","AS1457","AS1459","AS1460","AS1461","AS1469","CT1471","CT1472","FB1473","AS1476","CT1477","AS1478","AS1532","EN1547","CT1658","VN1659","CT1660","CT1672","AS1829","IN1888","FB2035","CT2632","CT2639","CT2650","CT2667","FB1463","AS1467","AS1470","CT1005","CT1353","CT1359","CT1362","EN1368","CT1389","EN1543","EN1593","EN1628","EN1631","EN1633","CT1637","VN1642","CT1643","CT1657","CT1661","EN1663","CT1666","CT1669","CT1670","VN1684","CT1685","CT1687","CT1689","CT1690","CT1692","VN1693","CT1695","CT1696","EN1895","FB2087","FB2089","EN2094","VN2644","VN2645","CT2646","CT2649","CT2662","CT2664","VN2666","VN1667","VN1676","VN1678","VN1680","VN2682","CT1665","CT1675","CT1694","CT1640","CT1646","CT1662","CT1664","CT1668","CT1671","CT1674","CT1682","CT1683","CT1057","CT1058","CT1071","CT1072","FB1292","EN1293","EN1294","EN1297","EN1298","EN1299","EN1302","EN1303","FB1308","FB1311","FB1315","FB1318","EN1321","EN1325","EN1326","EN1327","EN1330","EN1331","EN1333","CT1336","CT1337","CT1338","CT1339","CT1340","CT1341","CT1342","CT1343","CT1344","CT1345","CT1347","CT1348","CT1349","CT1350","CT1351","CT1352","CT1354","CT1355","CT1356","CT1357","CT1358","CT1360","CT1361","CT1363","CT1365","CT1366","CT1367","EN1369","EN1370","CT1371","CT1372","CT1373","CT1374","CT1376","CT1378","EN1380","CT1381","CT1383","CT1384","CT1385","CT1386","CT1388","CT1391","CT1392","CT1393","CT1394","CT1395","CT1396","CT1397","EN1544","EN1545","EN1546","FB1553","CT1570","EN1571","CT1691","CT1698","CT1699","FB1703","FB1712","FB1718","CT1849","CT1850","CT1851","CT1870","FB1872","FB1875","FB1876","CT1879","CT1891","CT1892","CT1893","CT1896","CT1898","CT1899","CT1900","CT1901","CT1903","CT1904","CT1905","CT1906","CT1907","CT1908","CT1909","CT1910","CT1911","CT1912","CT1913","CT1914","CT1920","CT1925","CT1926","CT1927","CT1930","CT1931","CT1935","CT1936","CT1939","CT1940","EN1941","FB1943","CT1950","CT1951","CT1952","CT1953","CT1955","CT1956","CT1962","CT1965","VN1968","CT1970","CT1973","CT1975","CT1977","CT1980","CT1990","CT1992","CT1993","CT2003","CT2007","CT2009","CT2010","CT2011","CT2012","CT2014","CT2015","CT2017","VN2018","CT2019","VN2022","VN2023","CT2025","VN2028","VN2029","EN2030","FB2034","FB2040","FB2042","FB2045","EN2047","FB2054","CT2055","FB2076","CT2100","CT2582","CT2583","CT2585","CT2587","CT2588","CT2589","CT1954","VN2033","IN1174","IN1175","IN1177","IN1178","IN1828","IN1830","AS1835","IN1842","IN1843","IN1844","IN1854","IN1855","IN1878","IN1885","IN1886","IN1887","IN1889","IN1890","IN2073","VN1673","VN2634","VN2635","VN2636","VN2648","VN2660","VN1677","VN1679","VN1969","VN1986","VN1999","VN2031","VN1681","AS1098","AS1099","AS1104","AS1105","AS1106","AS1107","AS1108","AS1109","AS1110","AS1230","AS1400","AS1733","AS1743","AS1744","VN1415","VN1416","VN1417","VN1419","VN1420","VN1421","VN1422","CT1479","AS1480","AS1485","AS1486","AS1487","VN2068","CT1648","CT1730","CT1731","VN1747","CT2677","FB1101","FB1102","FB1232","VN1418","FB1434","CT2062","CT2064","VN2066","VN2067","CT2069","VN2070","IN1332","IN2102","IN2250","VN2678","AS1488","CT1748","CT1749","CT2071"]'; // json_encode($sku);
?>
<html>
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script>
        $(document).ready(function() {
            jQuery.ajaxSetup({async:false});
            var ids = JSON.parse('<?php echo $jsonstr; ?>');
            var skus = JSON.parse('<?php echo $jsonSku; ?>');


            for (var l = 0; l < ids.length; l++) {
                var dt = [];
                var url = "http://www.monogramonline.com/"+ids[l]+".html";
                $.get("proxy.php", {url: url}, function (response) {
                    var data = $(response).find('div.itemOptionWrap');
                    var options = data.find(".multiLineOption");
                    var json = [];
                    options.each(function (i) {
                        var label = $(this).find('.itemoption');
                        var ele = {};
                        label.find("span").remove();
                        if (label.text().indexOf("Offer") > -1) {
                            //console.log("offer bad");
                            return false;
                        }
                        if (label.text().indexOf("Monogram:") > -1) {
                            var note = $(this).find('.monogramComment');
                            note.find("a").remove();
                            var countInput = 0;
                            $(this).find("input").each(function (k) {
                                countInput++;
                            });
                            ele.type = "text";
                            ele.max = countInput;
                            ele.label = label.text();
                            ele.short = i;
                            ele.note = note.text();
                            json.push(ele);
                        }
                        else if (label.text().indexOf("Confirmation") > -1) {
                            ele.type = "select";
                            ele.label = label.text();
                            var op = [];
                            $(this).find("select option").each(function () {
                                var o = {};
                                o.text = $(this).text();
                                o.value = $(this).attr("value");
                                o.price = 0;
                                op.push(o);
                            });
                            ele.options = op;
                            ele.short = i;
                            var note = label.next();
                            note.find("a").remove();
                            ele.note = note.text();
                            json.push(ele);
                        }
                        else {
                            var ctrl = $(this).find(":input");
                            if (ctrl.prop('type') == 'select-one') {
                                ele.type = "select";
                                ele.label = label.text();
                                var op = [];
                                $(this).find("select option").each(function () {
                                    var tr = $(this).text().split("(");
                                    var opt = "";
                                    var opp = 0;
                                    if (tr.length > 1) {
                                        opt = tr[0];
                                        opp = tr[1].slice(1, -1);
                                    }
                                    else {
                                        opt = $(this).text();
                                    }
                                    var o = {};
                                    o.text = opt;
                                    o.value = opt;
                                    o.price = opp;
                                    op.push(o);
                                });
                                ele.options = op;
                                ele.short = i;
                                ele.note = "";
                                json.push(ele);
                            }
                            else if (ctrl.prop('type') == 'text') {
                                ele.type = "text";
                                ele.max = 15; //Todo:check in
                                ele.label = label.text();
                                ele.short = i;
                                ele.note = "";
                                json.push(ele);
                            }
                        }
                    });
                    var js = {};
                    js[skus[l]] = json;
                    dt.push(js);
                });
                $.post("o_script.php", { data:dt}, function(data) {
                    console.log(data);
                });
            }
        });
    </script>
</head>
<body>
</body>
</html>