<?php
/**
 * Julfiker_Party extension
 * 
 * NOTICE OF LICENSE
 * 
 * This source file is subject to the MIT License
 * that is bundled with this package in the file LICENSE.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/mit-license.php
 * 
 * @category       Julfiker
 * @package        Julfiker_Party
 * @copyright      Copyright (c) 2017
 * @license        http://opensource.org/licenses/mit-license.php MIT License
 */
/**
 * Event view template
 *
 * @category    Julfiker
 * @package     Julfiker_Party
 * @author      Ultimate Module Creator
 */
?>
<?php $_event = $this->getCurrentEvent();?>
<?php echo $this->getMessagesBlock()->getGroupedHtml() ?>
<?php
$startAt = date_create($_event->getStartAt());
$endAt = date_create($_event->getEndAt());
?>
<div class="col-md-12">
    <div class="page-title event-title">
        <h1 class="panel-title" >
            <div style="overflow: hidden" >
               <span class="pull-left"><?php echo $_event->getTitle();?></span>
               <span style="color:#ec008b; background: #fff" class="badge pull-right">
                   <i class="fa fa-calendar" aria-hidden="true"></i>
                   <?php echo date_format($startAt, 'M - d, Y') ?>
               </span>
            </div>
        </h1>
    </div>

    <div style="overflow: hidden">
        <div class="pull-left">
            <a href="#" class="btn btn-default btn-xs"><i class="fa fa-star" aria-hidden="true"></i> Interested</a>
            <a href="#" class="btn btn-default btn-xs"><i class="fa fa-check" aria-hidden="true"></i> Going</a>
        </div>
        <div class="pull-right">
            <a href="#" class="btn btn-default btn-xs"> <i class="fa fa-share-square-o" aria-hidden="true"></i> Invite </a>
        </div>
    </div>
    <hr />
    <b>
        <i class="fa fa-pie-chart" aria-hidden="true" style="color:#ec008b"></i>
         <?php echo $this->__("Over view")?>
    </b>
    <div class="row">
        <div class="col-md-3" style="text-align: center">
            <div class="chart" data-percent="0"></div> <!--Todo: calculate percentage -->
            <label><?php echo $this->__("Achieved order")?> <?php echo Mage::helper('core')->currency($this->getTotalOrderAmount(), true, false);?> </label>
        </div>
        <div class="col-md-9" style="padding-top: 20px;">
            <div class="col-md-3" style="text-align: center">
                <div class="chart" data-percent="<?php echo $this->getPercentageJoined() ?>"></div>
                <label><?php echo $this->__("Joined")?> <?php echo $this->getTotalJoined() ?></label>
            </div>
            <div class="col-md-3" style="text-align: center">
                <div class="chart" data-percent="<?php echo $this->getPercentageInterested() ?>"></div>
                <label><?php echo $this->__("Interested")?> <?php echo $this->getTotalInterested() ?></label>
            </div>
            <div class="col-md-3" style="text-align: center">
                <div class="chart" data-percent="<?php echo $this->getPercentageInvites()?>"></div>
                <label><?php echo $this->__("Invited") ?> <?php echo $this->getTotalInvites()?> </label>
            </div>
            <div class="col-md-3" style="text-align: center">
                <div class="chart" data-percent="<?php echo $this->getPercentageRejected()?>"></div>
                <label><?php echo $this->__("Rejected") ?> <?php echo $this->getTotalReject()?> </label>
            </div>
        </div>
    </div>

    <br />
    <?php if ($_event->getDesc()): ?>
        <p>
            <b><i class="fa fa-info-circle"  style="color:#ec008b" aria-hidden="true"></i> <?php echo $this->__("About the event")?> <br /> </b>
            <?php echo $_event->getDesc()?>
        </p>
    <?php endif ?>

    <p>
        <b> <i class="fa fa-location-arrow" aria-hidden="true" style="color:#ec008b"></i> <?php echo $this->__("Event host and location")?> <br /> </b>
        <?php echo $this->__("Hosted by") ?> <?php echo Mage::helper("julfiker_party/event")->getHostName($_event->getHost()); ?> <br />
        <?php echo $_event->getAddress() ?>, <?php echo $_event->getCity() ?> - <?php echo $_event->getZip() ?>, <?php echo $_event->getCountry() ?>
    </p>

    <p>
        <b><i class="fa fa-clock-o" aria-hidden="true" style="color:#ec008b"></i> <?php echo $this->__("Event date and time")?>   </b> <br />
        <b> <?php echo $this->__("Start date")?>:</b> <?php echo date_format($startAt,"M - d, Y"); ?>,  <b><?php echo $this->__("Start time")?> :</b> <?php echo date_format($startAt,"h:i A"); ?> <br />
        <b> <?php echo $this->__("End date")?>: </b> <?php echo date_format($endAt,"M - d, Y"); ?> ,  <b><?php echo $this->__("End time")?> :</b> <?php echo date_format($endAt,"h:i A"); ?>
    </p>
</div>

<script>
    jQuery(document).ready(function() {
        jQuery('.chart').circliful({
            animate : true,
            diameter : 5000,
            guage: 2,
            coverBg: '#fff',
            bgColor: '#fff',
            fillColor: '#fff',
            foregroundColor: "#ec008b",
            percentSize: '15px',
            percentWeight: 'bold'
        });
    });

</script>